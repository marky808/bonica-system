# 新しいテンプレートの情報

## Phase 1 完了 ✅

**作成日時**: 2025年11月15日

---

## 請求書テンプレート（新）

### スプレッドシート情報

- **タイトル**: BONICA請求書テンプレート（新）
- **スプレッドシートID**: `1xjRbRELuUKx5uKVctt6M8jugHZrxQXetoxCabACOz-E`
- **URL**: [https://docs.google.com/spreadsheets/d/1xjRbRELuUKx5uKVctt6M8jugHZrxQXetoxCabACOz-E](https://docs.google.com/spreadsheets/d/1xjRbRELuUKx5uKVctt6M8jugHZrxQXetoxCabACOz-E)
- **シートID**: `1710287251`

### 実装内容

#### ✅ 完了した機能

1. **9列構造の明細テーブル**
   - A列: 日付（中央揃え、罫線）
   - B列: 品名（罫線）
   - C列: 単価（通貨フォーマット ¥#,##0、右揃え）
   - D列: 数量（数値フォーマット #,##0.##、右揃え）
   - E列: 単位（中央揃え）
   - F列: 税率（中央揃え、8%/10%）
   - G列: 税抜金額（計算式 =C*D、通貨フォーマット）
   - H列: 消費税（計算式 =G*税率、通貨フォーマット、切り捨て）
   - I列: 備考（罫線）

2. **ヘッダー部分**
   - 1行目: 青いタイトルバー (#00A0E9) 「請求書」
   - 2行目: 会社名「ボニカアグリジェント株式会社」
   - 3行目: 法人番号「T1234567890123」（プレースホルダー）
   - 4行目: 住所「〒123-4567 東京都○○区○○ 1-2-3」（プレースホルダー）
   - 5行目: 電話番号「TEL: 03-1234-5678」（プレースホルダー）
   - 7行目: お客様名 `{{customerName}} 御中`
   - 8行目: 請求日・請求番号 `{{invoiceDate}}` `{{invoiceNumber}}`
   - 10行目: 明細テーブルヘッダー（青背景、白文字）

3. **計算式**
   - 税抜金額: `=IF(AND(C行<>"", D行<>""), C行*D行, "")`
   - 消費税: `=IF(AND(G行<>"", F行<>""), ROUNDDOWN(G行*VALUE(SUBSTITUTE(F行, "%", ""))/100, 0), "")`
   - 小計（税抜）: `=SUM(G11:G50)`
   - 消費税合計: `=SUM(H11:H50)`
   - 合計: `=小計+消費税`

4. **税率別集計ブロック**
   - 8%対象: `=SUMIF(F11:F50, "8%", G11:G50)`
   - 消費税（8%）: `=SUMIF(F11:F50, "8%", H11:H50)`
   - 10%対象: `=SUMIF(F11:F50, "10%", G11:G50)`
   - 消費税（10%）: `=SUMIF(F11:F50, "10%", H11:H50)`

5. **振込先情報ブロック**
   - 銀行名: ○○銀行（プレースホルダー）
   - 支店名: ○○支店（プレースホルダー）
   - 口座種別: 普通
   - 口座番号: 1234567（プレースホルダー）
   - 口座名義: ボニカアグリジェント（カ

6. **書式設定**
   - 列幅: A=100px, B=250px, C=100px, D=80px, E=60px, F=70px, G=120px, H=100px, I=200px
   - タイトル背景色: #00A0E9（青）
   - ヘッダー行背景色: #00A0E9（青）、白文字
   - 明細行罫線: グレー (#CCCCCC) 実線
   - フォント: 通常10-11pt、タイトル18pt、会社名14pt
   - 合計行: 上線太線、下線二重線

### テンプレート構造

```
1行目:  【請求書】（青背景、A-I列結合）
2行目:  ボニカアグリジェント株式会社
3行目:  法人番号: T1234567890123
4行目:  〒123-4567 東京都○○区○○ 1-2-3
5行目:  TEL: 03-1234-5678
6行目:  （空行）
7行目:  （右側）{{customerName}} 御中
8行目:  （右側）請求日: {{invoiceDate}} | 請求番号: {{invoiceNumber}}
9行目:  （空行）
10行目: ヘッダー行（日付|品名|単価|数量|単位|税率|税抜金額|消費税|備考）
11-50行目: 明細行（40行、数式組み込み済み）
51行目: （空行）
52行目: 【税率別集計】
53行目: 8%対象 | 金額
54行目: 消費税（8%） | 金額
55行目: 10%対象 | 金額
56行目: 消費税（10%） | 金額
57行目: （空行）
58行目: 小計 | 金額
59行目: 消費税 | 金額
60行目: 合計 | 金額（太線）
61行目: （空行）
62行目: 【お振込先】
63-67行目: 銀行情報
```

### 環境変数設定（次のステップ）

Phase 4の本番移行時に以下の環境変数を設定してください：

```bash
GOOGLE_SHEETS_NEW_INVOICE_TEMPLATE_SHEET_ID="1xjRbRELuUKx5uKVctt6M8jugHZrxQXetoxCabACOz-E"
```

---

## 納品書テンプレート（新）

### スプレッドシート情報

- **タイトル**: BONICA納品書テンプレート（新）
- **スプレッドシートID**: `19ozm2YlEG2QIcGWPKc-nPfXCbE48JKPNWdiut4txqV4`
- **URL**: [https://docs.google.com/spreadsheets/d/19ozm2YlEG2QIcGWPKc-nPfXCbE48JKPNWdiut4txqV4](https://docs.google.com/spreadsheets/d/19ozm2YlEG2QIcGWPKc-nPfXCbE48JKPNWdiut4txqV4)
- **シートID**: `1326467723`

### 実装内容

請求書テンプレートと同じ9列構造・計算式・書式を実装していますが、以下の点が異なります：

#### 主な違い

1. **タイトル**: 「納品書」
2. **背景色**: 薄い紫 (#E6E6FA / rgb(0.902, 0.902, 0.980)) - 請求書との差別化
3. **項目名**: 「納品日」「納品書番号」（プレースホルダー: `{{deliveryDate}}` `{{deliveryNumber}}`）
4. **その他の構造**: 請求書と同一（9列、計算式、税率別集計など）

### 環境変数設定（次のステップ）

Phase 4の本番移行時に以下の環境変数を設定してください：

```bash
GOOGLE_SHEETS_NEW_DELIVERY_TEMPLATE_SHEET_ID="19ozm2YlEG2QIcGWPKc-nPfXCbE48JKPNWdiut4txqV4"
```

---

## 次のステップ

### ✅ 完了済み

- [x] 請求書テンプレートの作成
- [x] 9列構造の実装
- [x] 計算式の組み込み
- [x] 書式設定の実装
- [x] 税率別集計の実装
- [x] 振込先情報の追加

### 🔲 次のアクション

1. **視覚的な確認**
   - [ ] 上記URLをブラウザで開いて、PDFデザインと比較
   - [ ] すべての計算式が正しく動作することを確認
   - [ ] 書式（色、罫線、フォント）が正しいことを確認

2. **会社情報の更新**（実際の値に置き換え）
   - [ ] 法人番号（T番号）
   - [ ] 住所
   - [ ] 電話番号
   - [ ] 銀行名・支店名・口座番号

3. **納品書テンプレートの作成**
   - [ ] 同様のスクリプトで納品書バージョンを作成

4. **Phase 2: システム連携の準備**
   - [ ] TypeScript型定義の更新
   - [ ] データ投入ロジックの実装

---

**Phase 1 実施時間**: 約10分（スクリプト作成 + 実行 + デバッグ）

**Phase 1 完了日時**: 2025年11月15日
